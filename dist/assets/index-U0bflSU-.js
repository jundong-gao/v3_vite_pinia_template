import{h as e,g as t,v as a,i as s,j as r,k as i,e as l}from"./vender_element-plus@2.5.6_vue@3.4.19-Cz1JTsiA.js";import{_ as n}from"./index.vue_vue_type_script_lang-D5-_3WPT.js";import{d as o,i as h,M as u,C as d,q as p,o as m,H as c,G as g,J as v}from"./vender_@vue_runtime-core@3.4.19-DxPlDNzv.js";import{k as y}from"./vender_@vue_reactivity@3.4.19-dBGfcXZR.js";import{t as f}from"./test-BTm22xzk.js";import{L as _}from"./vender_@vue_shared@3.4.19-CyPW2GST.js";import"./vender_lodash-es@4.17.21-DuYRbacB.js";import"./vender_@vue_runtime-dom@3.4.19-BrtrBs_4.js";import"./vender_async-validator@4.2.5-Cuo4gI4y.js";import"./vender_@vueuse_core@9.13.0_vue@3.4.19-CS2dMUaZ.js";import"./vender_@vueuse_shared@9.13.0_vue@3.4.19-BvGCUM93.js";import"./vender_dayjs@1.11.10-BKYM6hcM.js";import"./vender_@element-plus_icons-vue@2.3.1_vue@3.4.19-BZDyjLJY.js";import"./vender_@ctrl_tinycolor@3.6.1-D2oWfImC.js";import"./vender_@sxzz_popperjs-es@2.11.7-D3lHDW-0.js";import"./vender_normalize-wheel-es@1.2.0-Vn5vHDCm.js";import"./vender_axios@1.6.7-X0xcXtXw.js";const b=o({props:{columns:{type:Array,default:()=>[]},searchRowNum:{type:Number,default:4},searchText:{type:String,default:"搜索"},resetText:{type:String,default:"重置"},api:{type:Function,default:()=>null},showPage:{type:Boolean,default:!0}},setup:()=>({tableData:y([]),loading:y(!1),searchParams:y({}),searchFormRef:y({}),pageNum:y(1),pageSize:y(10),total:y(0),pageSizes:y([10,20,30,40]),layout:y("total, sizes, prev, pager, next, jumper")}),computed:{searchColumns(){let e=this.columns.filter((e=>e.search));return e.length&&e.push({label:"",key:"search",span:e.length%this.searchRowNum==0?24:24/this.searchRowNum}),e}},render(){let i;return h("div",null,[h("div",{class:"base-table-search"},[h(e,{ref:"searchFormRef",model:this.searchParams},{default:()=>[h(n,{"row-num":this.searchRowNum,columns:this.searchColumns,"form-data":this.searchParams},{search:()=>h("div",{class:"flex-jasc-end"},[h(t,{onClick:()=>this.reset()},{default:()=>[this.resetText]}),h(t,{type:"primary",onClick:()=>this.search()},{default:()=>[this.searchText]})])})]})]),u(h(s,d({border:!1,data:this.tableData},this.$attrs),(l=i=this.columns.map((e=>this.renderTableColumn(e))),"function"==typeof l||"[object Object]"===Object.prototype.toString.call(l)&&!p(l)?i:{default:()=>[i]})),[[a,this.loading]]),this.showPage?h("div",{class:"flex-jasc-end p-[10px]"},[h(r,{layout:this.layout,"page-sizes":this.pageSizes,small:!0,background:!0,total:this.total,modelValue:this.pageNum,modelModifiers:{"current-page":!0},"onUpdate:modelValue":[e=>this.pageNum=e,e=>this.pageSize=e],onSizeChange:e=>this.sizeChange(e),onCurrentChange:e=>this.currentChange(e)},null)]):null]);var l},mounted(){this.reset()},methods:{renderTableColumn(e){if(e.hidden)return null;let t={};this.$slots[e.key]&&(t.default=t=>{var a,s;return null==(s=(a=this.$slots)[e.key])?void 0:s.call(a,t)}),this.$slots[e.key+"Header"]&&(t.header=t=>{var a,s;return null==(s=(a=this.$slots)[e.key+"Header"])?void 0:s.call(a,t)});let a={...e};return delete a.children,h(i,d({align:"center"},a,{prop:e.key}),{default:()=>[e.children?e.children.map((e=>this.renderTableColumn(e))):null],...t})},getList(){"function"==typeof this.api&&(this.loading=!0,this.api({...this.searchParams,pageNum:this.pageNum,pageSize:this.pageSize}).then((e=>{this.tableData=e.data.list,this.total=e.data.total,0===this.tableData.length&&this.pageNum>1&&(this.pageNum=1,this.getList())})).finally((()=>{this.loading=!1})))},search(){this.getList()},reset(){this.searchFormRef.resetFields(),this.pageNum=1,this.getList()},sizeChange(e){this.pageSize=e,this.getList()},currentChange(e){this.pageNum=e,this.getList()}}}),j=o({__name:"index",setup(e){const a=y([{label:"姓名",key:"name",search:!0,type:"input"},{label:"信息",key:"salary",children:[{label:"信息1",key:"info1"},{label:"信息2",key:"info2"}]},{label:"年龄",key:"age",width:600,search:!0,type:"select",data:[],async:()=>Promise.resolve([{label:"18-25岁",value:1},{label:"26-35岁",value:2}])},{label:"性别",key:"gender"},{label:"电话",key:"phone",search:!0,type:"input"},{label:"操作",key:"action",fixed:"right",width:200}]),s=e=>{let t={...e,page:e.pageNum};return l.success(`请求参数===>${JSON.stringify(t)}`),f(t).then((e=>({data:{list:e.data,total:100}})))};return(e,r)=>{const i=t,l=b;return m(),c(l,{columns:a.value,stripe:"",api:s,"max-height":"calc(100vh - 210px)"},{age:g((({row:e})=>[v("自定义年龄表格单元 ====> "+_(e),1)])),info2Header:g((e=>[v("自定义表头 ==== "+_(e.column.label),1)])),action:g((()=>[h(i,{size:"small",type:"danger",link:""},{default:g((()=>[v("删除")])),_:1}),h(i,{size:"small",link:"",type:"primary"},{default:g((()=>[v("编辑")])),_:1})])),_:1},8,["columns"])}}});export{j as default};
