import{d as e,r as l,P as t,o as a,c as u,O as v,a as i,R as n,S as o,f as s,e as c,t as m,g as h,w as d,h as p,b as r,z as g,T as f}from"./index-B9hNVsHm.js";/* empty css                  */import{_ as x}from"./_plugin-vue_export-helper-BCo6x5W8.js";const w={class:"base-cut-img"},b=x(e({__name:"index",props:{left:{},top:{},width:{},height:{}},setup(e,{expose:c}){let m=e,h=l(m.left||0),d=l(m.top||0),p=l(m.width||50),r=l(m.height||50),g=t((()=>({width:`${p.value}px`,height:`${r.value}px`,left:`${h.value}px`,top:`${d.value}px`}))),f=l({clientX:0,clientY:0,left:0,top:0}),x=l(!1);const b=e=>{var l,t;x.value=!0,f.value.clientX=e.clientX,f.value.clientY=e.clientY,f.value.left=h.value,f.value.top=d.value;let a=(null==(l=e.target.parentElement)?void 0:l.clientWidth)||0,u=(null==(t=e.target.parentElement)?void 0:t.clientHeight)||0;document.onmousemove=e=>{h.value=Math.max(0,f.value.left+e.clientX-f.value.clientX),d.value=Math.max(0,f.value.top+e.clientY-f.value.clientY),h.value=Math.min(a-p.value,h.value),d.value=Math.min(u-r.value,d.value)},document.onmouseup=()=>{x.value=!1,document.onmousemove=null,document.onmouseup=null}};let y=l({x:0,y:0,width:0,height:0,left:0,top:0}),_=l(!1);const M=(e,l)=>{var t,a,u,v;y.value.x=e.clientX,y.value.y=e.clientY,y.value.width=p.value,y.value.height=r.value,y.value.left=h.value,y.value.top=d.value,_.value=!0;let i=(null==(a=null==(t=e.target.parentElement)?void 0:t.parentElement)?void 0:a.getBoundingClientRect().width)||0,n=(null==(v=null==(u=e.target.parentElement)?void 0:u.parentElement)?void 0:v.getBoundingClientRect().height)||0;document.onmousemove=e=>{_.value&&("right-bottom"===l&&(r.value=y.value.height+e.clientY-y.value.y,p.value=y.value.width+e.clientX-y.value.x,r.value=Math.min(n-d.value,r.value),p.value=Math.min(i-h.value,p.value)),"left-top"===l&&(h.value=Math.max(y.value.left+e.clientX-y.value.x,0),d.value=Math.max(y.value.top+e.clientY-y.value.y,0),h.value>0&&(p.value=y.value.width-e.clientX+y.value.x),d.value>0&&(r.value=y.value.height-e.clientY+y.value.y)),"left-bottom"===l&&(h.value=y.value.left+e.clientX-y.value.x,h.value=Math.max(h.value,0),h.value>0&&(p.value=y.value.width-e.clientX+y.value.x),r.value=y.value.height+e.clientY-y.value.y,r.value>n-d.value&&(r.value=n-d.value)),"right-top"===l&&(d.value=y.value.top+e.clientY-y.value.y,d.value=Math.max(d.value,0),p.value=y.value.width+e.clientX-y.value.x,d.value>0&&(r.value=y.value.height-e.clientY+y.value.y),p.value>i-h.value&&(p.value=i-h.value)))},document.onmouseup=()=>{_.value=!1,document.onmousemove=null,document.onmouseup=null}};return c({maskStyle:{left:h,top:d,width:p,height:r}}),(e,l)=>(a(),u("div",w,[v(e.$slots,"default",{},void 0,!0),i("div",{class:"base-cut-img-mask",style:o(s(g)),onMousedown:n(b,["stop"])},[i("div",{class:"base-cut-img-btns-item left-top",onMousedown:l[0]||(l[0]=n((e=>M(e,"left-top")),["stop"]))},null,32),i("div",{class:"base-cut-img-btns-item left-bottom",onMousedown:l[1]||(l[1]=n((e=>M(e,"left-bottom")),["stop"]))},null,32),i("div",{class:"base-cut-img-btns-item right-top",onMousedown:l[2]||(l[2]=n((e=>M(e,"right-top")),["stop"]))},null,32),i("div",{class:"base-cut-img-btns-item right-bottom",onMousedown:l[3]||(l[3]=n((e=>M(e,"right-bottom")),["stop"]))},null,32)],36)]))}}),[["__scopeId","data-v-14fd91d4"]]),y={class:"flex"},_={class:"left flex-jac"},M=["src"],X={class:"right flex-jac"},Y=["src"],k={key:0,class:"flex-aic"},E=x(e({__name:"index",setup(e){const v=l({}),n=t((()=>{var e;return null==(e=v.value)?void 0:e.maskStyle})),o=l(""),s=l(""),x=e=>{o.value=URL.createObjectURL(e.file)},w=()=>{let e=document.querySelector(".left-img"),l=document.createElement("canvas"),t=l.getContext("2d");l.width=e.width,l.height=e.height,t.drawImage(e,0,0,l.width,l.height);let a=document.createElement("canvas"),u=a.getContext("2d");a.width=n.value.width.value,a.height=n.value.height.value,u.drawImage(l,n.value.left.value,n.value.top.value,n.value.width.value,n.value.height.value,0,0,n.value.width.value,n.value.height.value);let v=a.toDataURL();s.value=v};return(e,l)=>{const t=b,E=g,R=f;return a(),u("div",null,[c(m(n.value)+" ",1),i("div",y,[i("div",_,[o.value?(a(),h(t,{key:0,ref_key:"cutRef",ref:v,class:"left-img-box",left:80,top:80,width:140,height:140},{default:d((()=>[i("img",{class:"left-img",src:o.value,draggable:"false"},null,8,M)])),_:1},512)):p("",!0),o.value?p("",!0):(a(),h(R,{key:1,accept:"image/*",action:"#","show-file-list":!1,"http-request":x},{default:d((()=>[r(E,{type:"primary",size:"small"},{default:d((()=>[c("选择图片")])),_:1})])),_:1}))]),i("div",X,[i("img",{class:"right-img",src:s.value},null,8,Y)])]),o.value?(a(),u("div",k,[r(R,{accept:"image/*",action:"#","show-file-list":!1,"http-request":x},{default:d((()=>[r(E,{type:"primary",size:"small"},{default:d((()=>[c("重新选择")])),_:1})])),_:1}),r(E,{class:"ml-2 mt-[2px]",type:"primary",onClick:w,size:"small"},{default:d((()=>[c("确定")])),_:1})])):p("",!0)])}}}),[["__scopeId","data-v-4c41bea3"]]);export{E as default};
