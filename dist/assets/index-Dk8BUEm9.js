import{g as e,o as t}from"./vender_element-plus@2.5.6_vue@3.4.19-gQs-ezRw.js";import{w as l}from"./vender_@vue_runtime-dom@3.4.19-CxaGZhfE.js";import{d as a,l as u,o as v,c as i,A as o,a as n,L as s,G as m,H as r,K as d,i as c}from"./vender_@vue_runtime-core@3.4.19-B3wHNLg9.js";import{k as h,u as p}from"./vender_@vue_reactivity@3.4.19-CT0fOkG_.js";import{l as g,L as f}from"./vender_@vue_shared@3.4.19-BqlcddsJ.js";import{_}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./vender_lodash-es@4.17.21-BOD1Zk9H.js";import"./vender_@vueuse_core@9.13.0_vue@3.4.19-gmFKCLvb.js";import"./vender_@vueuse_shared@9.13.0_vue@3.4.19-JgXqF0wo.js";import"./vender_@element-plus_icons-vue@2.3.1_vue@3.4.19-YOBRtq19.js";import"./vender_@sxzz_popperjs-es@2.11.7-D3lHDW-0.js";import"./vender_@ctrl_tinycolor@3.6.1-D2oWfImC.js";import"./vender_dayjs@1.11.10-BKYM6hcM.js";import"./vender_async-validator@4.2.5-Cuo4gI4y.js";import"./vender_memoize-one@6.0.0-Ds0C_khL.js";import"./vender_normalize-wheel-es@1.2.0-Vn5vHDCm.js";import"./vender_@floating-ui_dom@1.6.3-CSrpQn7c.js";import"./vender_@floating-ui_core@1.6.0-4pTMFri_.js";import"./vender_@floating-ui_utils@0.2.1-BjL72BsT.js";const x={class:"base-cut-img"},w=_(a({__name:"index",props:{left:{},top:{},width:{},height:{}},setup(e,{expose:t}){let a=e,s=h(a.left||0),m=h(a.top||0),r=h(a.width||50),d=h(a.height||50),c=u((()=>({width:`${r.value}px`,height:`${d.value}px`,left:`${s.value}px`,top:`${m.value}px`}))),f=h({clientX:0,clientY:0,left:0,top:0}),_=h(!1);const w=e=>{var t,l;_.value=!0,f.value.clientX=e.clientX,f.value.clientY=e.clientY,f.value.left=s.value,f.value.top=m.value;let a=(null==(t=e.target.parentElement)?void 0:t.clientWidth)||0,u=(null==(l=e.target.parentElement)?void 0:l.clientHeight)||0;document.onmousemove=e=>{s.value=Math.max(0,f.value.left+e.clientX-f.value.clientX),m.value=Math.max(0,f.value.top+e.clientY-f.value.clientY),s.value=Math.min(a-r.value,s.value),m.value=Math.min(u-d.value,m.value)},document.onmouseup=()=>{_.value=!1,document.onmousemove=null,document.onmouseup=null}};let y=h({x:0,y:0,width:0,height:0,left:0,top:0}),j=h(!1);const b=(e,t)=>{var l,a,u,v;y.value.x=e.clientX,y.value.y=e.clientY,y.value.width=r.value,y.value.height=d.value,y.value.left=s.value,y.value.top=m.value,j.value=!0;let i=(null==(a=null==(l=e.target.parentElement)?void 0:l.parentElement)?void 0:a.getBoundingClientRect().width)||0,o=(null==(v=null==(u=e.target.parentElement)?void 0:u.parentElement)?void 0:v.getBoundingClientRect().height)||0;document.onmousemove=e=>{j.value&&("right-bottom"===t&&(d.value=y.value.height+e.clientY-y.value.y,r.value=y.value.width+e.clientX-y.value.x,d.value=Math.min(o-m.value,d.value),r.value=Math.min(i-s.value,r.value)),"left-top"===t&&(s.value=Math.max(y.value.left+e.clientX-y.value.x,0),m.value=Math.max(y.value.top+e.clientY-y.value.y,0),s.value>0&&(r.value=y.value.width-e.clientX+y.value.x),m.value>0&&(d.value=y.value.height-e.clientY+y.value.y)),"left-bottom"===t&&(s.value=y.value.left+e.clientX-y.value.x,s.value=Math.max(s.value,0),s.value>0&&(r.value=y.value.width-e.clientX+y.value.x),d.value=y.value.height+e.clientY-y.value.y,d.value>o-m.value&&(d.value=o-m.value)),"right-top"===t&&(m.value=y.value.top+e.clientY-y.value.y,m.value=Math.max(m.value,0),r.value=y.value.width+e.clientX-y.value.x,m.value>0&&(d.value=y.value.height-e.clientY+y.value.y),r.value>i-s.value&&(r.value=i-s.value)))},document.onmouseup=()=>{j.value=!1,document.onmousemove=null,document.onmouseup=null}};return t({maskStyle:{left:s,top:m,width:r,height:d}}),(e,t)=>(v(),i("div",x,[o(e.$slots,"default",{},void 0,!0),n("div",{class:"base-cut-img-mask",style:g(p(c)),onMousedown:l(w,["stop"])},[n("div",{class:"base-cut-img-btns-item left-top",onMousedown:t[0]||(t[0]=l((e=>b(e,"left-top")),["stop"]))},null,32),n("div",{class:"base-cut-img-btns-item left-bottom",onMousedown:t[1]||(t[1]=l((e=>b(e,"left-bottom")),["stop"]))},null,32),n("div",{class:"base-cut-img-btns-item right-top",onMousedown:t[2]||(t[2]=l((e=>b(e,"right-top")),["stop"]))},null,32),n("div",{class:"base-cut-img-btns-item right-bottom",onMousedown:t[3]||(t[3]=l((e=>b(e,"right-bottom")),["stop"]))},null,32)],36)]))}}),[["__scopeId","data-v-14fd91d4"]]),y={class:"flex"},j={class:"left flex-jac"},b=["src"],M={class:"right flex-jac"},X=["src"],Y={key:0,class:"flex-aic"},k=_(a({__name:"index",setup(l){const a=h({}),o=u((()=>{var e;return null==(e=a.value)?void 0:e.maskStyle})),p=h(""),g=h(""),_=e=>(p.value=URL.createObjectURL(e.file),Promise.resolve()),x=()=>{let e=document.querySelector(".left-img"),t=document.createElement("canvas"),l=t.getContext("2d");t.width=e.width,t.height=e.height,l.drawImage(e,0,0,t.width,t.height);let a=document.createElement("canvas"),u=a.getContext("2d");a.width=o.value.width.value,a.height=o.value.height.value,u.drawImage(t,o.value.left.value,o.value.top.value,o.value.width.value,o.value.height.value,0,0,o.value.width.value,o.value.height.value);let v=a.toDataURL();g.value=v};return(l,u)=>{const h=w,k=e,E=t;return v(),i("div",null,[s(f(o.value)+" ",1),n("div",y,[n("div",j,[p.value?(v(),m(h,{key:0,ref_key:"cutRef",ref:a,class:"left-img-box",left:80,top:80,width:140,height:140},{default:r((()=>[n("img",{class:"left-img",src:p.value,draggable:"false"},null,8,b)])),_:1},512)):d("",!0),p.value?d("",!0):(v(),m(E,{key:1,accept:"image/*",action:"#","show-file-list":!1,"http-request":_},{default:r((()=>[c(k,{type:"primary",size:"small"},{default:r((()=>[s("选择图片")])),_:1})])),_:1}))]),n("div",M,[n("img",{class:"right-img",src:g.value},null,8,X)])]),p.value?(v(),i("div",Y,[c(E,{accept:"image/*",action:"#","show-file-list":!1,"http-request":_},{default:r((()=>[c(k,{type:"primary",size:"small"},{default:r((()=>[s("重新选择")])),_:1})])),_:1}),c(k,{class:"ml-2 mt-[2px]",type:"primary",onClick:x,size:"small"},{default:r((()=>[s("确定")])),_:1})])):d("",!0)])}}}),[["__scopeId","data-v-c5e3a014"]]);export{k as default};
